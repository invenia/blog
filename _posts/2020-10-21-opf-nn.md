---

layout: post

title: "Using Neural Networks for Predicting Solutions to Optimal Power Flow"

author: "Letif Mones"

comments: false

tags: neural network, optimal power flow, power grids, regression, classification



---

## Introduction
---------------

In a previous blog post we discussed the fundamental concepts of the optimal power flow (OPF).
In their principal form AC-OPF are non-linear non-convex optimization problems that are in general expensive to solve.
Due to their large-scale size, solving even their linearized approximation (DC-OPF) is a challenging optimization task.

On the other hand, integration of renewable resources increased uncertainty in grid conditions that requires electricity grid operators to solve OPF near real-time in order to have the most accurate state of the system.
In recent years there has been an intense research in machine learning (ML) to shift the computational effort away from real-time to offline training providing an almost instant prediction.
This blog post focuses on a specific set of machine learning approaches that apply neural networks (NNs) for predicting (directly or indirectly) solutions to OPF.

## General form of OPF
----------------------

OPF problems can be expressed by the following concise form of mathematical programming:

$$
\begin{equation}
	\begin{aligned}
		& \min \limits_{y}\ f(x, y) \\
		& \mathrm{s.\ t.} \ \ c_{i}^{\mathrm{E}}(x, y) = 0 \quad i = 1, \dots, n \\
		& \quad \; \; \; c_{j}^{\mathrm{I}}(x, y) \ge 0 \quad j = 1, \dots, m \\
	\end{aligned}
	\label{opt}
\end{equation}
$$

where $$x$$ is the vector of grid parameters and $$y$$ is the vector of optimization variables, $$f(x, y)$$ is the objective (or cost) function to minimize subject to equality constraints $$c_{i}^{\mathrm{E}}(x, y) \in \mathcal{C}^{\mathrm{E}}$$ and inequality constraints $$c_{j}^{\mathrm{I}}(x, y) \in \mathcal{C}^{\mathrm{I}}$$, where for convenience we introduced $$\mathcal{C}^{\mathrm{E}}$$ and $$\mathcal{C}^{\mathrm{I}}$$ that denote the sets of equality and inequality constraints with corresponding cardinalities $$n = \lvert \mathcal{C}^{\mathrm{E}} \rvert$$ and $$m = \lvert \mathcal{C}^{\mathrm{I}} \rvert$$.
We emphasize that the objective function is optimized solely with respect to the optimization variables and grid parameters only parameterize the objective and constraint functions. 
For example...

The most widely used approach to solve the above optimization problem (that can be non-linear, non-convex and even mixed-integer) is the interior point method[^Boyd04] [^Nocedal06] [^Wachter06].
Interior-point or barrier method is a highly efficient algorithm that looks for the solution by an iterative manner.
However, it requires the computation of the Hessian (second derivatives) of the Lagrangian of the system with respect to the optimization variables at each iteration step.
Due to the non-convex nature of the power flow equations appearing in the equality constraints the method can be prohibitedly slow for large-scale systems.

The formulation of eq. $$\ref{opt}$$ gives us the possibility to look at OPF as an operator mapping the grid parameters ($$x$$) to the optimal value of the optimization variables ($$y^{*}$$).
In a more general sense, the objective and constraint functions are also arguments of this operator.
Also, in this discussion we assume that the exact solution of the OPF problem is always provided by the interior-point method.
Therefore, the operator is parameterized implicitly by the starting value of the optimization variables ($$y_{0}$$).
In principle, the actual value of $$y_{0}$$ does not alter the solution the operator provides but can significantly affect the convergence of the interior-point method and therefore the total computational time.
The general form of the OPF operator then can be written as:

$$
\begin{equation}
    \Phi: \Omega \to \mathbb{R}^{n_{y}}: \quad \Phi\left( x, y_{0}, f, \left\{c_{i}^{\mathrm{E}} \right\}_{i=1}^{n}, \left\{c_{j}^{\mathrm{I}} \right\}_{j=1}^{m} \right) = y^{*}
	\label{opf-operator}
\end{equation}
$$

where $$\Omega$$ is an abstract set within the values of the operator arguments are allowed to change and $$n_{y}$$ is the dimension of the optimization variables.
We note that a special case of the general form is the DC-OPF operator, whose mathematical properties have been thoroughly investigated recently[^Zhou20].

In many recurring problems most of the arguments of the OPF operator are fixed and only (some of) the grid parameters vary.
For these cases we introduce a simpler notation of the OPF function:

$$
\begin{equation}
	F_{\Phi}: \mathbb{R}^{n_{x}} \to \mathbb{R}^{n_{y}}: \quad F_{\Phi}(x) = y^{*}
	\label{opf-function}
\end{equation}
$$

where $$n_{x}$$ and $$n_{y}$$ are the dimensions of grid parameter and optimization variables, respectively.
We also introduce the feasible set of all feasible points of the OPF: $$\mathcal{F}_{\Phi}$$.
Apparently, $$y^{*} \in \mathcal{F}_{\Phi}$$ and depending on the grid parameters the problem may be infeasible: $$\mathcal{F}_{\Phi} = \emptyset$$.

The daily task of electricity grid operators is to provide solutions for the constantly changing grid parameters $$x_{t}$$: $$F_{\Phi}(x_{t}) = y_{t}^{*}$$.

## NN based approaches for predicting OPF solutions
---------------------------------------------------

The ML methods we discuss here apply either 

---
[^Nocedal06]: J. Nocedal and S. J. Wrigh, "Numerical Optimization," New York: Springer, 2006
[^Wachter06]: A. Wächter and L. Biegler, "On the implementation of an interior-point filter line-search algorithm for large-scale nonlinear programming," Math. Program. 106, 25–57, 2006, doi: 10.1007/s10107-004-0559-y.
[^Boyd04]: S. Boyd and L. Vandenberghe, "Convex Optimization, " New York: Cambridge University Press, 2004
[^Zhou20]: F. Zhou, J. Anderson and S. H. Low, "The Optimal Power Flow Operator: Theory and Computation," arXiv, https://arxiv.org/abs/1907.02219
